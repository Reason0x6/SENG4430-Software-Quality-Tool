<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Software Quality Report</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
        <style>
            .dropdown-menu-end, .dropdown-menu-end .nav-item{
               background-color: #212529 !important;
            }
            .dropdown-menu-end .nav-item:hover {
                background-color: rgba(33, 37, 41,0.8) !important;
            }
            html {
                scroll-padding-top: 70px; /* height of sticky header */
            }

            .nested-if-table {
                width: 100%;
                max-width: 100%;
                margin-bottom: 1rem;
                background-color: transparent;
            }
          .table-responsive {
            display: block;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
          }
          .nested-if-table th,
          .nested-if-table td {
            padding: 5px;
            text-align: left;
          }


             .accordion {
                 background-color: #eee;
                 color: #444;
                 cursor: pointer;
                 padding: 18px;
                 width: 100%;
                 border: none;
                 text-align: left;
                 outline: none;
                 font-size: 15px;
                 transition: 0.4s;
             }

            .active, .accordion:hover {
                background-color: #ccc;
            }

            .panel {
                padding: 0 18px;
                display: none;
                background-color: white;
                overflow: hidden;
            }

        </style>
    </head>
    <body>
        <!-- Responsive navbar-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container">
                <a class="navbar-brand" href="#">Software Quality Report</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Report Sections</a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                <li class="nav-item"><a class="nav-link" href="#Fan">Fan-in/Fan-out</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Creds">Credentials in code</a></li>
                                <li class="nav-item"><a class="nav-link" href="#WMC">Weighted methods per class</a></li>
                                <li class="nav-item"><a class="nav-link" href="#CBO">Coupling between object classes</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Error">Error Handling</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Comments">Code Comments & Formatting</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Cyclomatic">Cyclomatic complexity</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Cohesion">Lack of cohesion in methods</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Fog">Fog index</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Depth">Depth of conditional nesting</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Redundant">Redundant code & code duplication</a></li>
                                <li class="nav-item"><a class="nav-link" href="#Bill">Bill Of Materials</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Page content-->
        <div class="container">
            <div class="mt-5">
                <h1>Seng4430 - Group 1 - Generated Report</h1>
                <p class="lead">This comprehensive analysis provides invaluable insights into the software's integrity, performance, and adherence to industry standards. Through meticulous examination and advanced metrics, this report aims to empower stakeholders with actionable data to enhance the software's quality and reliability. Dive into the findings to uncover areas of strength, pinpoint opportunities for improvement, and propel your project towards excellence.</p>
                <h2 id="Fan">Fan-in/Fan-out</h2>
                <p><b>Fan-in:</b> The number of methods depending on a specific method.<br/>
                <b>Fan-out:</b> The number of methods a specific method depends on.</p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Fan-out_(software)</a></p>
                <p>Ref: <a>https://stackoverflow.com/questions/4092228/design-principle-high-fan-in-vs-high-fan-out</a></p>
                <button class="accordion">View Fan-in/Fan-out Results </button>
                <div class="panel">
                    <!------ @@Fan-in/Fan-out Output@@  ---->
                </div>
                <hr/>
                <h2 id="Creds">Credentials in code</h2>
                <p>List of potential API keys and passwords found in the codebase. Manual scanning is required to ensure no credentials are present.</p>
                <p>Ref: <a>https://blog.gitguardian.com/secrets-in-source-code-episode-3-3-building-reliable-secrets-detection/</a></p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Entropy_(information_theory)</a></p>
                <button class="accordion">View Found Credentials </button>
                <div class="panel">
                    <!------ @@Credentials Output@@  ---->
                </div>
                <hr/>
                <h2 id="WMC">Weighted methods per class (WMC)</h2>
                <p>The complexity of a class by counting and assessing the complexity of its methods.</p>
                <p>Ref: <a>https://isroset.org/pub_paper/IJSRCSE/ISROSET-IJSRCSE-00043.pdf</a></p>
                <button class="accordion">View WMC Results</button>
                <div class="panel">
                    <!------ @@WMC Output@@  ---->
                </div>
                <hr/>
                <h2 id="CBO">Coupling between object classes (CBO)</h2>
                <p>Measure of how closely interconnected different classes are within the codebase.</p>
                <p>Ref: <a>https://isroset.org/pub_paper/IJSRCSE/ISROSET-IJSRCSE-00043.pdf</a></p>
                <button class="accordion">View CBO Results</button>
                <div class="panel">
                    <!------ @@CBO Output@@  ---->
                </div>
                <hr/>
                <h2 id="Error">Error Handling</h2>
                <p>How errors and exceptions are managed and processed within the code to maintain stability and robustness.</p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Fan-out_(software)</a></p>
                <button class="accordion">View Error Handling Results</button>
                <div class="panel">
                    <!------ @@Error Output@@  ---->
                </div>
                <hr/>
                <h2 id="Comments">Code Comments & Formatting</h2>
                <p>Evaluation of the clarity, consistency, and adequacy of comments and code formatting practices to enhance code readability and maintainability.</p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Fan-out_(software)</a></p>
                <button class="accordion">View Code Comments & Formatting Results</button>
                <div class="panel">
                    <!------ @@Code Comments & Formatting Output@@  ---->
                </div>
                <hr/>
                <h2 id="Cyclomatic">Cyclomatic complexity</h2>
                <p>Quantitative measure of the complexity of a program based on the number of linearly independent paths through its source code. This will only show functions that have a complexity greater than 4. This has been selected as a single fuction that handles 4 branches of logic may be handling too much complexity and/or violating 'SOLID' principles</p>
                <p>Ref: <a href="https://www.baeldung.com/solid-principles" target="_blank">SOLID programming principles</a></p>
                <p>Ref: <a href="https://www.geeksforgeeks.org/cyclomatic-complexity/" target="_blank">Cyclomatic Complexity</a></p>
                <button class="accordion">View Cyclomatic complexity Results</button>
                <div class="panel">
                    <!------ @@Cyclomatic Output@@  ---->
                    <div class="table-responsive">
                        <table class="table redundant-code-table" id="complexityTable">
                            <thead>
                            <tr>
                                <th>Class</th>
                                <th>Method Name</th>
                                <th>Complexity Score</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <p id="complexityTableScore">Complexity: </p>
                    <p><em>The above table shows individual functions with a high complexity.</em></p>
                </div>

                <hr/>
                <h2 id="Cohesion">Lack of cohesion in methods (LCOM)</h2>
                <p>Evaluation of the degree of cohesion within methods or functions, measuring the strength of the relationships among statements and variables within the same method.</p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Fan-out_(software)</a></p>
                <button class="accordion">View LCOM Results</button>
                <div class="panel">
                    <!------ @@LCOM Output@@  ---->
                    <div class="table-responsive">
                        <table class="table redundant-code-table" id="LCOMTable">
                            <thead>
                            <tr>
                                <th>Class Name</th>
                                <th>LCOM Score</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <p>Avg LCOM Score: <span id="LCOMTableScore"></span> | 0 = Fully cohesive, 1 = No cohesion</p>
                    <p><em>0 indicates perfect cohesion (all methods in the class use all fields) and 1 indicates no cohesion (no method uses any field more than once).</em></p>
                </div>

                <hr/>
                <h2 id="Fog">Fog index</h2>
                <p>Calculation of the readability of a piece of text based on the average number of words per sentence and the percentage of complex words.</p>
                <p>Ref: <a>https://en.wikipedia.org/wiki/Fan-out_(software)</a></p>
              <button class="accordion">View Fog Index Results</button>
                <div class="panel">
                    <div class="container"  style="margin-top: 10px;">
                        <h3>Code Comments Fog Index</h3>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>Property</th>
                                <th>Value</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>Comment Count</td>
                                <td id="commentCount" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Comment Sentences</td>
                                <td id="commentSentences" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Comment Complex Words</td>
                                <td id="commentComplexWords" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Comment Range</td>
                                <td id="commentRange" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td><b>Evaluation of Comment Fog Index</b></td>
                                <td id="commentEval" class="fogData">Error Calculating</td>
                            </tr>
                            </tbody>
                        </table>

                        <h3>All Code Fog Index</h3>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>Property</th>
                                <th>Value</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>Code Count</td>
                                <td id="codeCount" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Code Sentences/lines</td>
                                <td id="codeSentences" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Code Complex Words</td>
                                <td id="codeComplexWords" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td>Code Range</td>
                                <td id="codeRange" class="fogData">0</td>
                            </tr>
                            <tr>
                                <td><b>Evaluation of Code Fog Index</b></td>
                                <td id="codeEval" class="fogData">Error Calculating</td>
                            </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
                <hr/>

                <h2 id="Bill">Bill Of Materials</h2>
                <p>A bill of materials (BoM) typically refers to a list of dependencies or components used in the project. Selecting an import from the list will take you to <em>mvnreposiitory.com</em> to view the information for the given import.</p>
                <button class="accordion">View Bill of Materials</button>
                <div class="panel">
                    <div class="container" style="margin-top: 10px;">
                        <h3>Standard Java Imports</h3>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>Imports that are contained within JDK</th>
                            </tr>
                            </thead>
                            <tbody id="importTreeBody">
                            </tbody>
                        </table>
                    </div>
                    <div class="container">
                        <h3>Non-Standard Imports</h3>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>All scanned non-standard imports</th>
                            </tr>
                            </thead>
                            <tbody id="NSTDimportTreeBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <hr/>
                <hr/>
                <h2 id="Depth">Depth of conditional nesting</h2>
                <p>Analysis of the number of nested conditional statements within the code, indicating its complexity and potential readability issues.</p>
                <button class="accordion">View Nested If Score</button>
                <div class="panel">
                    <div class="table-responsive">
                        <table class="table nested-if-table" id="nestedIfTable">
                            <thead>
                            <tr>
                                <th>Function Name</th>
                                <th>Nested If's</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <p id="nestedIfScore">Nested if's score: </p>
                </div>
                <hr/>
                <h2 id="Redundant">Redundant code & code duplication</h2>
                <p>Identification of duplicate or unnecessary code segments to improve code maintainability and efficiency.</p>
                <button class="accordion">View Redundant code & code duplication</button>
                <div class="panel">
                    <div class="table-responsive">
                        <table class="table redundant-code-table" id="redundantCodeTable">
                            <thead>
                            <tr>
                                <th>Function Name</th>
                                <th>Unreachable Code Count</th>
                                <th>Duplicated code</th>
                                <th>Function Usage</th>
                                <th>Variable Usage</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <p id="redundantCodeScore">Redundant code score: </p>
                </div>
                <hr/>
            </div>
        </div>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <script>
            var acc = document.getElementsByClassName("accordion");
            var i;

            for (i = 0; i < acc.length; i++) {
                acc[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    var panel = this.nextElementSibling;
                    if (panel.style.display === "block") {
                        panel.style.display = "none";
                    } else {
                        panel.style.display = "block";
                    }
                });
            }
        </script>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                let cyclicResp = '' +
                    '@@Cyclic Complex Response Here@@'
                    +'';
                let data = JSON.parse(cyclicResp);
                const tableBody = document.getElementById('complexityTable').getElementsByTagName('tbody')[0];
                let totalScore = 0;
                for (const [className, methods] of Object.entries(data)) {
                    if(className === "_Admin_Total"){
                        totalScore = methods[0];
                        break;
                    }

                        for (const score of Object.entries(methods)) {
                            if(score[1].b <= 4){
                                continue;
                            }
                            let row = tableBody.insertRow();
                            let cell1 = row.insertCell(0);
                            let cell2 = row.insertCell(1);
                            let cell3 = row.insertCell(2);
                            cell1.textContent = className;
                            cell2.textContent = score[1].a;
                            cell3.textContent = score[1].b;
                        }
                }
                document.getElementById('complexityTableScore').innerHTML = 'Average Cyclomatic Complexity of all classes: <b>' + totalScore.b + '</b>, which represents a risk level of: <b>' + totalScore.a + '</b>';

            });
        </script>

        <script>
          document.addEventListener('DOMContentLoaded', function() {
              let nestedResp = '' +
                  '@@nested if code response here@@'
                  +'';
              let data = JSON.parse(nestedResp);
                    const tableBody = document.getElementById('nestedIfTable').getElementsByTagName('tbody')[0];
                    let totalScore = 0;
                    for (const [functionName, score] of Object.entries(data)) {
                        let row = tableBody.insertRow();
                        let cell1 = row.insertCell(0);
                        let cell2 = row.insertCell(1);
                        cell1.textContent = functionName + "()";

                        // Change display based on the score
                        cell2.textContent = score > 0 ? `Yes (${score})` : "No";

                        totalScore += parseInt(score, 10);
                    }
                    document.getElementById('nestedIfScore').textContent = 'Total nested if\'s score: ' + totalScore;

         });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {

                let redresponse = '' +
                    '@@Redudant code response here@@'
                    +'';
                let data = JSON.parse(redresponse);

                const tableBody = document.getElementById('redundantCodeTable').getElementsByTagName('tbody')[0];
                if(data && data.unreachableCodeCounts){
                    // Iterate over the keys in unreachableCodeCounts
                    Object.keys(data.unreachableCodeCounts).forEach(methodName => {
                        let row = tableBody.insertRow();
                        let functionNameCell = row.insertCell(0);
                        functionNameCell.textContent = methodName + "()";

                        let unreachableCodeCountCell = row.insertCell(1);
                        let unreachableCodeCount = data.unreachableCodeCounts[methodName];
                        unreachableCodeCountCell.textContent = unreachableCodeCount === 0 ? "Reachable" : "Unreachable (" + unreachableCodeCount + ")";

                        let duplicatedCodeCell = row.insertCell(2);
                        let duplicatedCodeCount = data.duplicatedCodeCounts[methodName + "()"] || 0;
                        duplicatedCodeCell.textContent = duplicatedCodeCount > 0 ? "Yes (" + duplicatedCodeCount + ")" : "No";

                        let functionUsageCell = row.insertCell(3);
                        functionUsageCell.textContent = data.uniqueMethodNames.includes(methodName) ? "Not used" : "Used";

                        let variableUsageCell = row.insertCell(4);
                        variableUsageCell.textContent = data.currentUnusedVariables[methodName] || "All used";
                    });
                }


                // Display totals
                if (data && data.totals) {
                    let totalsRow = tableBody.insertRow();
                    totalsRow.insertCell(0).textContent = "Totals:";
                    totalsRow.insertCell(1).textContent = "Total unreachable code: " + data.totals.totalUnreachableCode;
                    totalsRow.insertCell(2).textContent = "Total duplicated code: " + data.totals.totalDuplicatedCode;
                    totalsRow.insertCell(3).textContent = "Total unused functions: " + data.totals.totalUnusedFunctions;
                    totalsRow.insertCell(4).textContent = "Total methods with unused variables: " + data.totals.totalMethodsWithUnusedVariables;

                    let grandTotal = data.totals.totalUnreachableCode + data.totals.totalDuplicatedCode + data.totals.totalUnusedFunctions + data.totals.totalMethodsWithUnusedVariables;
                    document.getElementById('redundantCodeScore').textContent = 'Total redundant code score: ' + grandTotal;

                }

            });
        </script>
        <script>
            // Function to create table rows recursively
            function createTableRows(node, depth, parentKey, elementID) {
                if (node.children && Object.keys(node.children).length > 0){
                    let d = '';
                    for (let i = 0; i < depth; i++) {
                        d += i===0? '└──' : '──';
                    }
                    d+= ' ';
                    depth++;
                    for (const [key, value] of Object.entries(node.children)) {
                        let searchOnX = '';
                        if(elementID === 'NSTDimportTreeBody'){
                           searchOnX = "<span style='float: right'> View this Import on: <a target='_blank' href='https://search.maven.org/search?q="+ (parentKey ? parentKey + '.' : '') +key+"'>Maven Central Repository</a> or <a target='_blank' href='https://mvnrepository.com/search?q="+ (parentKey ? parentKey + '.' : '') +key+"'>MVN Repository</a></span>";
                        }

                        if(depth === 1){
                            document.getElementById(elementID).innerHTML += '<tr><td> <b>'+ key + searchOnX + '</td></tr>';
                        }else if(value.children && Object.keys(value.children).length > 0){
                            document.getElementById(elementID).innerHTML += '<tr><td>' + d + key + searchOnX + '</td></tr>';
                        } else{
                            document.getElementById(elementID).innerHTML += '<tr><td>' + d + key + searchOnX + '</td></tr>';
                        }

                        createTableRows(value, depth, parentKey === undefined ? key : parentKey + '.' + key, elementID);
                    }

                } else {
                    document.getElementById(elementID).innerHTML += '<tr></tr>';
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                // Sample JSON data
                let stdResp = '' +
                    '@@StdImport@@'
                    + '';
                let jsonData = JSON.parse(stdResp);


                // Populate table with JSON data
                createTableRows(jsonData, 0, undefined, 'importTreeBody');
            });

            document.addEventListener('DOMContentLoaded', function() {
                // Sample JSON data
                let nonStdResp = '' +
                    '@@nonStdImport@@'
                    + '';
                let jsonData = JSON.parse(nonStdResp);

                // Populate table with JSON data
                createTableRows(jsonData, '', undefined, 'NSTDimportTreeBody');
            });

        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Sample JSON data
                let fogResp = '' +
                    '@@fogResp@@'
                    + '';
                let jsonData = JSON.parse(fogResp);
                let foggy = document.getElementsByClassName('fogData');


                for (let i = 0; i < foggy.length; i++) {
                    foggy[i].innerHTML = jsonData[i];
                }
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                let cyclicResp = '' +
                    '@@LCOMSCORES@@'
                    +'';
                let data = JSON.parse(cyclicResp);
                const tableBody = document.getElementById('LCOMTable').getElementsByTagName('tbody')[0];
                let totalScore = 0;
                for (const x of Object.entries(data)) {
                        let row = tableBody.insertRow();
                        let cell1 = row.insertCell(0);
                        let cell2 = row.insertCell(1);
                        cell1.textContent = x[0];

                        if(x[1] === "NaN"){
                            x[1] = "Class is not able to be evaluated - It may be an interface.";
                        }else{

                            x[1] = parseFloat(Number(x[1]).toFixed(5));
                            totalScore += x[1];
                        }
                    cell2.textContent = x[1];

                }

                document.getElementById('LCOMTableScore').innerHTML = '<b>' + parseFloat((totalScore/ Object.entries(data).length).toFixed(5))  + '</b>';
            });
        </script>

        <script>
            function toggleViewById(id) {
                let div = document.getElementById(id);
                if (div.style.display === "block") {
                    div.style.display = "none"
                } else {
                    div.style.display = "block"
                }
            }
        </script>
    </body>
</html>
